import{s as x,g as U,a as G,n as W,c as X,e as I,_ as Y,b as J}from"./obstacle-BPyBaOu9.js";import{g as c,I as j,d as E,b as u,e as p,F as O,r as w,n as k,u as o,h as Q,i as $,w as b,j as Z,k as K,l as ee,m as te,p as se,q as ne,C as oe,M as le,f as d,s as T,t as D,_ as P,c as ae,D as re,v as L,B as H,x as ie,y as ce,z as y,A,E as ue,G as _e}from"./index-CT7wa57o.js";var pe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M536.1 273H488c-4.4 0-8 3.6-8 8v275.3c0 2.6 1.2 5 3.3 6.5l165.3 120.7c3.6 2.6 8.6 1.9 11.2-1.7l28.6-39c2.7-3.7 1.9-8.7-1.7-11.2L544.1 528.5V281c0-4.4-3.6-8-8-8zm219.8 75.2l156.8 38.3c5 1.2 9.9-2.6 9.9-7.7l.8-161.5c0-6.7-7.7-10.5-12.9-6.3L752.9 334.1a8 8 0 003 14.1zm167.7 301.1l-56.7-19.5a8 8 0 00-10.1 4.8c-1.9 5.1-3.9 10.1-6 15.1-17.8 42.1-43.3 80-75.9 112.5a353 353 0 01-112.5 75.9 352.18 352.18 0 01-137.7 27.8c-47.8 0-94.1-9.3-137.7-27.8a353 353 0 01-112.5-75.9c-32.5-32.5-58-70.4-75.9-112.5A353.44 353.44 0 01171 512c0-47.8 9.3-94.2 27.8-137.8 17.8-42.1 43.3-80 75.9-112.5a353 353 0 01112.5-75.9C430.6 167.3 477 158 524.8 158s94.1 9.3 137.7 27.8A353 353 0 01775 261.7c10.2 10.3 19.8 21 28.6 32.3l59.8-46.8C784.7 146.6 662.2 81.9 524.6 82 285 82.1 92.6 276.7 95 516.4 97.4 751.9 288.9 942 524.8 942c185.5 0 343.5-117.6 403.7-282.3 1.5-4.2-.7-8.9-4.9-10.4z"}}]},name:"history",theme:"outlined"};function V(i){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},l=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),l.forEach(function(s){de(i,s,e[s])})}return i}function de(i,t,e){return t in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e,i}var M=function(t,e){var l=V({},t,e.attrs);return c(j,V({},l,{icon:pe}),null)};M.displayName="HistoryOutlined";M.inheritAttrs=!1;var me={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M924.8 625.7l-65.5-56c3.1-19 4.7-38.4 4.7-57.8s-1.6-38.8-4.7-57.8l65.5-56a32.03 32.03 0 009.3-35.2l-.9-2.6a443.74 443.74 0 00-79.7-137.9l-1.8-2.1a32.12 32.12 0 00-35.1-9.5l-81.3 28.9c-30-24.6-63.5-44-99.7-57.6l-15.7-85a32.05 32.05 0 00-25.8-25.7l-2.7-.5c-52.1-9.4-106.9-9.4-159 0l-2.7.5a32.05 32.05 0 00-25.8 25.7l-15.8 85.4a351.86 351.86 0 00-99 57.4l-81.9-29.1a32 32 0 00-35.1 9.5l-1.8 2.1a446.02 446.02 0 00-79.7 137.9l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.3 56.6c-3.1 18.8-4.6 38-4.6 57.1 0 19.2 1.5 38.4 4.6 57.1L99 625.5a32.03 32.03 0 00-9.3 35.2l.9 2.6c18.1 50.4 44.9 96.9 79.7 137.9l1.8 2.1a32.12 32.12 0 0035.1 9.5l81.9-29.1c29.8 24.5 63.1 43.9 99 57.4l15.8 85.4a32.05 32.05 0 0025.8 25.7l2.7.5a449.4 449.4 0 00159 0l2.7-.5a32.05 32.05 0 0025.8-25.7l15.7-85a350 350 0 0099.7-57.6l81.3 28.9a32 32 0 0035.1-9.5l1.8-2.1c34.8-41.1 61.6-87.5 79.7-137.9l.9-2.6c4.5-12.3.8-26.3-9.3-35zM788.3 465.9c2.5 15.1 3.8 30.6 3.8 46.1s-1.3 31-3.8 46.1l-6.6 40.1 74.7 63.9a370.03 370.03 0 01-42.6 73.6L721 702.8l-31.4 25.8c-23.9 19.6-50.5 35-79.3 45.8l-38.1 14.3-17.9 97a377.5 377.5 0 01-85 0l-17.9-97.2-37.8-14.5c-28.5-10.8-55-26.2-78.7-45.7l-31.4-25.9-93.4 33.2c-17-22.9-31.2-47.6-42.6-73.6l75.5-64.5-6.5-40c-2.4-14.9-3.7-30.3-3.7-45.5 0-15.3 1.2-30.6 3.7-45.5l6.5-40-75.5-64.5c11.3-26.1 25.6-50.7 42.6-73.6l93.4 33.2 31.4-25.9c23.7-19.5 50.2-34.9 78.7-45.7l37.9-14.3 17.9-97.2c28.1-3.2 56.8-3.2 85 0l17.9 97 38.1 14.3c28.7 10.8 55.4 26.2 79.3 45.8l31.4 25.8 92.8-32.9c17 22.9 31.2 47.6 42.6 73.6L781.8 426l6.5 39.9zM512 326c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm79.2 255.2A111.6 111.6 0 01512 614c-29.9 0-58-11.7-79.2-32.8A111.6 111.6 0 01400 502c0-29.9 11.7-58 32.8-79.2C454 401.6 482.1 390 512 390c29.9 0 58 11.6 79.2 32.8A111.6 111.6 0 01624 502c0 29.9-11.7 58-32.8 79.2z"}}]},name:"setting",theme:"outlined"};function R(i){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},l=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(l=l.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),l.forEach(function(s){fe(i,s,e[s])})}return i}function fe(i,t,e){return t in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e,i}var S=function(t,e){var l=R({},t,e.attrs);return c(j,R({},l,{icon:me}),null)};S.displayName="SettingOutlined";S.inheritAttrs=!1;const ve={class:"h-full pointer-events-none"},ge=E({__name:"GridLines",setup(i){return(t,e)=>(u(),p("div",ve,[(u(!0),p(O,null,w(o(U)(),l=>(u(),p("div",{style:k({left:`${l*o(x).size}px`}),class:"w-[1px] h-full bg-blue-200 absolute"},null,4))),256)),(u(!0),p(O,null,w(o(G)(),l=>(u(),p("div",{style:k({top:`${l*o(x).size}px`}),class:"h-[1px] w-full bg-blue-200 absolute"},null,4))),256))]))}}),z=i=>{let t=Math.floor(i.offsetX/x.value.size),e=Math.floor(i.offsetY/x.value.size);return{x:t,y:e}},B=Q("stage",{state:()=>({historyList:[]}),persist:!0}),be={class:"config"},ye=E({__name:"StageInit",setup(i,{expose:t}){const e=$(!0),l=$(),s=$({size:30,width:600,height:600,name:"",id:"",obstacles:[],hero:{left:0,top:0,figure:"left"}}),v=async()=>{var n,g;if(await((n=l.value)==null?void 0:n.validateFields())){a(),s.value.id=W();const _=B(),f=K(s.value).cloned.value;_.$state.historyList.push(f),x.value=f,(g=l.value)==null||g.resetFields()}},a=()=>{e.value=!e.value};return t({changeVisible:a}),(r,n)=>{const g=ee,_=te,f=se,C=ne,F=oe,q=le;return u(),p("div",be,[c(q,{open:o(e),"onUpdate:open":n[4]||(n[4]=h=>Z(e)?e.value=h:null),centered:"",title:"场景编辑",onOk:v},{default:b(()=>[c(F,null,{default:b(()=>[c(C,{ref_key:"formRef",ref:l,model:o(s),onFinish:v},{default:b(()=>[c(_,{label:"地图名字",name:"name",required:""},{default:b(()=>[c(g,{"allow-clear":"",autofocus:"",value:o(s).name,"onUpdate:value":n[0]||(n[0]=h=>o(s).name=h)},null,8,["value"])]),_:1}),c(_,{label:"画布宽度",name:"width",required:""},{default:b(()=>[c(f,{max:1e3,value:o(s).width,"onUpdate:value":n[1]||(n[1]=h=>o(s).width=h),min:1},null,8,["value"])]),_:1}),c(_,{label:"画布高度",name:"height",required:""},{default:b(()=>[c(f,{max:900,value:o(s).height,"onUpdate:value":n[2]||(n[2]=h=>o(s).height=h),min:1},null,8,["value"])]),_:1}),c(_,{label:"网格大小",name:"size",required:""},{default:b(()=>[c(f,{value:o(s).size,"onUpdate:value":n[3]||(n[3]=h=>o(s).size=h),min:1},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["open"])])}}}),N="/assets/wall_black-C7eTvGve.png",he="/assets/wall_red-DDKfbgSg.png",m=$({image:N,obstacleType:"wall",pos:0}),xe=[{title:"黑白",value:N},{title:"红色",value:he}],Oe=[{type:"wall",label:"绘制墙"},{type:"monster",label:"绘制怪物"}],$e={class:"editor-tabs"},we={class:"wall-list p-4"},Ee={class:"flex gap-4"},Ce=["onClick"],Le=["src"],Pe={class:"text-gray-500"},ke=E({__name:"WallConfig",setup(i){const t=e=>{m.value.image=e};return(e,l)=>(u(),p("div",$e,[d("div",we,[l[0]||(l[0]=d("div",{class:"font-bold text-[1.3rem] mb-4"},"墙体风格",-1)),d("ul",Ee,[(u(!0),p(O,null,w(o(xe),s=>(u(),p("li",{class:"text-center",key:s.value,onClick:v=>t(s.value)},[d("div",{class:T(["p-[1px]",{"active bg-blue-200":s.value===o(m).image}])},[d("img",{src:s.value,width:"32"},null,8,Le)],2),d("div",Pe,D(s.title),1)],8,Ce))),128))])])]))}}),Te=P(ke,[["__scopeId","data-v-30ff8e9b"]]),De={class:"flex flex-col gap-4 mt-4 history-list p-4"},Me={key:0,class:"max-h-[200px] overflow-auto"},Se=["onClick"],Ie={class:"opacity-0 del"},Ae=E({__name:"History",setup(i){const t=B(),e=v=>{t.$state.historyList=t.$state.historyList.filter(a=>a.id!==v)},l=v=>{x.value=v},s=ae(()=>t.$state.historyList);return(v,a)=>{const r=H,n=ie,g=ce;return u(),p("div",null,[d("div",De,[a[0]||(a[0]=d("div",{class:"font-bold text-[1.5rem]"},"历史记录",-1)),o(s).length>0?(u(),p("ul",Me,[(u(!0),p(O,null,w(o(s),_=>(u(),p("li",{onClick:f=>l(_),class:T([{"active ":_.id===o(x).id},"px-4 flex justify-between items-center item hover:bg-gray-100 cursor-pointer"])},[d("div",null,D(_.name||"没有名称"),1),d("div",Ie,[c(n,{onConfirm:f=>e(_.id),title:"确定删除吗",placement:"bottomLeft"},{default:b(()=>[c(r,{shape:"circle",type:"ghost"},{default:b(()=>[c(o(re))]),_:1})]),_:2},1032,["onConfirm"])])],10,Se))),256))])):(u(),L(g,{key:1}))])])}}}),Ve=P(Ae,[["__scopeId","data-v-382cd0a5"]]),Re={class:"monster-list grid grid-cols-6 gap-2"},ze=["onClick"],je=E({__name:"Monster",setup(i){const t=Object.assign({"/src/assets/monster/Monster01-01.png":()=>y(()=>import("./Monster01-01-Bz4ii5ef.js"),[]),"/src/assets/monster/Monster02-01.png":()=>y(()=>import("./Monster02-01-Pc9vyRJp.js"),[]),"/src/assets/monster/Monster03-01.png":()=>y(()=>import("./Monster03-01-D0-PQ3cQ.js"),[]),"/src/assets/monster/Monster04-01.png":()=>y(()=>import("./Monster04-01-DTQaqLkc.js"),[]),"/src/assets/monster/Monster06-01.png":()=>y(()=>import("./Monster06-01-XBD_fTJy.js"),[]),"/src/assets/monster/Monster07-01.png":()=>y(()=>import("./Monster07-01-DFbSdz_1.js"),[]),"/src/assets/monster/Monster08-01.png":()=>y(()=>import("./Monster08-01-D7Xv7ofJ.js"),[]),"/src/assets/monster/Monster09-01.png":()=>y(()=>import("./Monster09-01-BslO-OyD.js"),[]),"/src/assets/monster/Monster10-01.png":()=>y(()=>import("./Monster10-01-6Q7aYg8m.js"),[]),"/src/assets/monster/Monster11-01.png":()=>y(()=>import("./Monster11-01-qJ36V8jb.js"),[]),"/src/assets/monster/Monster13-01.png":()=>y(()=>import("./Monster13-01-Qh0yaoBk.js"),[]),"/src/assets/monster/Monster14-01.png":()=>y(()=>import("./Monster14-01-dOEpwSLj.js"),[]),"/src/assets/monster/NPC01-01.png":()=>y(()=>import("./NPC01-01-B5GdBMKy.js"),[])});let e=$([]);function l(a){const r=/\/([^\/]+)\.png$/,n=a.match(r);return n&&n[1]?n[1]:null}Object.keys(t).forEach(a=>{l(a)&&e.value.push(a)});const s=(a,r)=>{m.value.image=a,m.value.pos=r},v=(a,r)=>({backgroundImage:`url(${a})`,backgroundPosition:`0px ${r*32}px`});return(a,r)=>(u(),p("div",null,[d("div",Re,[(u(!0),p(O,null,w(o(e),(n,g)=>(u(),p(O,null,[(u(),p(O,null,w(4,_=>d("div",{onClick:f=>s(n,_),class:T([{active:n===o(m).image&&o(m).pos===_},"h-[32px] monster w-[32px] cursor-pointer"]),style:k(v(n,_))},null,14,ze)),64))],64))),256))])]))}}),He=P(je,[["__scopeId","data-v-77258443"]]),Be={class:""},Ne={class:"flex flex-col gap-4"},Fe={class:"flex justify-between px-4 bg-slate-50 py-2"},qe={class:"flex gap-4"},Ue=E({__name:"EditorToolbar",emits:["displaysStageConfig"],setup(i,{emit:t}){const e=$(!1),l=a=>{m.value.obstacleType=a},s=t,v=()=>{s("displaysStageConfig")};return(a,r)=>{const n=H,g=S,_=ue;return u(),p("div",Be,[d("div",Ne,[r[1]||(r[1]=d("div",{class:"font-bold text-[1.5rem] flex justify-between"},[d("div",null,"工具箱")],-1)),d("div",Fe,[d("div",qe,[(u(!0),p(O,null,w(o(Oe),f=>(u(),L(n,{type:f.type===o(m).obstacleType?"primary":"default",shape:"round",onClick:C=>l(f.type)},{default:b(()=>[_e(D(f.label),1)]),_:2},1032,["type","onClick"]))),256))]),c(_,{title:"画布设置"},{default:b(()=>[c(n,{shape:"circle",onClick:r[0]||(r[0]=f=>e.value=!o(e)),type:o(e)?"primary":"ghost"},{icon:b(()=>[c(o(M))]),_:1},8,["type"]),c(n,{shape:"circle",type:"ghost",onClick:v},{icon:b(()=>[c(g)]),_:1})]),_:1})]),o(e)?(u(),L(Ve,{key:0})):A("",!0),o(m).obstacleType==="wall"?(u(),L(Te,{key:1})):o(m).obstacleType==="monster"?(u(),L(He,{key:2})):A("",!0)])])}}}),Ge={class:"sidebar edit-toolbar bg-white absolute right-4 top-4 p-4"},We=E({__name:"index",setup(i){const t=$(null),e=()=>!!window.event.target.closest("#grid-container"),l=()=>{if(!e())return;const a=n=>{if(!e())return;const{x:g,y:_}=z(n);I({x:g,y:_,type:m.value.obstacleType,id:"",image:m.value.image,pos:m.value.pos})},r=()=>{window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",r)};window.addEventListener("mousemove",a),window.addEventListener("mouseup",r)},s=a=>{if(!e())return;const{x:r,y:n}=z(a);X({x:r,y:n})||I({x:r,y:n,type:m.value.obstacleType,id:"",image:m.value.image,pos:m.value.pos})},v=a=>{x.value.obstacles=x.value.obstacles.filter(r=>r.id!=a.id)};return(a,r)=>{const n=ge,g=J,_=Y;return u(),p("div",{class:"w-full h-full flex justify-center items-center bg-blue-950 relative",onClick:s,onMousedown:l},[c(_,null,{default:b(()=>[c(n),c(g,{onSelect:v}),c(ye,{ref_key:"stageRef",ref:t},null,512)]),_:1}),d("div",Ge,[c(Ue,{onDisplaysStageConfig:r[0]||(r[0]=f=>{var C;return(C=o(t))==null?void 0:C.changeVisible()})})])],32)}}}),Je=P(We,[["__scopeId","data-v-09359683"]]);export{Je as default};
