import{s as t,g as w,a as C,d as $,h as i,_ as k,b as z}from"./obstacle-BPyBaOu9.js";import{a as D,o as u,d as v,c as L,b as g,e as m,f as M,n as h,u as l,_ as x,g as p,w as O}from"./index-CT7wa57o.js";const d=(e,s)=>{if(e==="wall")return!1;if(e==="monster")return $(s),D.warn("怪物被打死了"),!0;if(e==="prop")return!0},y=(e=-1)=>{const s=e>0,r=e<0,n=t.value.hero.left,a=t.value.hero.top,f=n-1<0&&r||n>w()-e-1&&s,c=t.value.obstacles.find(o=>{const _=n+e;return s&&o.x===_&&o.y===a||r&&o.x+1===n&&o.y===a?(d(o.type,o.id),o):!1});f||c||(t.value.hero.left+=e)},b=(e=-1)=>{const s=t.value.hero.top,r=t.value.hero.left,n=e>0,a=e<0,f=s-1<0&&a||s>C()-e-1&&n,c=t.value.obstacles.find(o=>n&&o.y===s+e&&o.x===r||a&&o.y+1===s&&o.x===r?(d(o.type,o.id),o):!1);f||c||(t.value.hero.top+=e)};u("ArrowDown",e=>{e.preventDefault(),t.value.hero.figure="front",b(1)});u("ArrowUp",e=>{t.value.hero.figure="back",e.preventDefault(),b(-1)});u("ArrowLeft",e=>{t.value.hero.figure="left",e.preventDefault(),y(-1)});u("ArrowRight",e=>{t.value.hero.figure="right",e.preventDefault(),y(1)});const B=()=>(i.value>=3&&(i.value=0),i.value++,{back:"32px",left:"96px",front:"0",right:"64px"}[t.value.hero.figure]),A=v({__name:"Hero",setup(e){const s=L(()=>({"background-position":`${i.value*32}px ${B()}`}));return(r,n)=>(g(),m("div",{class:"absolute z-10 hero flex justify-center items-center",style:h({height:`${l(t).size}px`,width:`${l(t).size}px`,left:`${l(t).hero.left*l(t).size}px`,top:`${l(t).hero.top*l(t).size}px`})},[M("div",{class:"image w-[32px] h-[32px]",style:h(l(s))},null,4)],4))}}),S=x(A,[["__scopeId","data-v-f5ff720e"]]),H={class:"main bg-gray-50 h-full relative flex justify-center items-center"},j=v({__name:"Main",setup(e){return t.value.obstacles.forEach(s=>{s.type}),(s,r)=>{const n=z,a=k;return g(),m("div",H,[p(a,null,{default:O(()=>[p(S),p(n)]),_:1})])}}}),R=x(j,[["__scopeId","data-v-598ec514"]]);export{R as default};
