import{s as x,g as F,a as N,n as q,c as U,e as P,_ as G,b as H}from"./obstacle-i0pMu2WC.js";import{g as i,I as W,d as E,b as c,e as u,F as $,r as w,n as T,u as l,h as X,i as O,w as b,j as Y,k as J,l as Q,m as Z,p as K,q as ee,C as te,M as se,f as p,s as D,t as I,_ as k,v as g,x as L,y as ne,z as oe,A as le,B as A,c as ae,D as re,E as ie,G as ce}from"./index-n6RClF3m.js";var _e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M924.8 625.7l-65.5-56c3.1-19 4.7-38.4 4.7-57.8s-1.6-38.8-4.7-57.8l65.5-56a32.03 32.03 0 009.3-35.2l-.9-2.6a443.74 443.74 0 00-79.7-137.9l-1.8-2.1a32.12 32.12 0 00-35.1-9.5l-81.3 28.9c-30-24.6-63.5-44-99.7-57.6l-15.7-85a32.05 32.05 0 00-25.8-25.7l-2.7-.5c-52.1-9.4-106.9-9.4-159 0l-2.7.5a32.05 32.05 0 00-25.8 25.7l-15.8 85.4a351.86 351.86 0 00-99 57.4l-81.9-29.1a32 32 0 00-35.1 9.5l-1.8 2.1a446.02 446.02 0 00-79.7 137.9l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.3 56.6c-3.1 18.8-4.6 38-4.6 57.1 0 19.2 1.5 38.4 4.6 57.1L99 625.5a32.03 32.03 0 00-9.3 35.2l.9 2.6c18.1 50.4 44.9 96.9 79.7 137.9l1.8 2.1a32.12 32.12 0 0035.1 9.5l81.9-29.1c29.8 24.5 63.1 43.9 99 57.4l15.8 85.4a32.05 32.05 0 0025.8 25.7l2.7.5a449.4 449.4 0 00159 0l2.7-.5a32.05 32.05 0 0025.8-25.7l15.7-85a350 350 0 0099.7-57.6l81.3 28.9a32 32 0 0035.1-9.5l1.8-2.1c34.8-41.1 61.6-87.5 79.7-137.9l.9-2.6c4.5-12.3.8-26.3-9.3-35zM788.3 465.9c2.5 15.1 3.8 30.6 3.8 46.1s-1.3 31-3.8 46.1l-6.6 40.1 74.7 63.9a370.03 370.03 0 01-42.6 73.6L721 702.8l-31.4 25.8c-23.9 19.6-50.5 35-79.3 45.8l-38.1 14.3-17.9 97a377.5 377.5 0 01-85 0l-17.9-97.2-37.8-14.5c-28.5-10.8-55-26.2-78.7-45.7l-31.4-25.9-93.4 33.2c-17-22.9-31.2-47.6-42.6-73.6l75.5-64.5-6.5-40c-2.4-14.9-3.7-30.3-3.7-45.5 0-15.3 1.2-30.6 3.7-45.5l6.5-40-75.5-64.5c11.3-26.1 25.6-50.7 42.6-73.6l93.4 33.2 31.4-25.9c23.7-19.5 50.2-34.9 78.7-45.7l37.9-14.3 17.9-97.2c28.1-3.2 56.8-3.2 85 0l17.9 97 38.1 14.3c28.7 10.8 55.4 26.2 79.3 45.8l31.4 25.8 92.8-32.9c17 22.9 31.2 47.6 42.6 73.6L781.8 426l6.5 39.9zM512 326c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm79.2 255.2A111.6 111.6 0 01512 614c-29.9 0-58-11.7-79.2-32.8A111.6 111.6 0 01400 502c0-29.9 11.7-58 32.8-79.2C454 401.6 482.1 390 512 390c29.9 0 58 11.6 79.2 32.8A111.6 111.6 0 01624 502c0 29.9-11.7 58-32.8 79.2z"}}]},name:"setting",theme:"outlined"};function S(d){for(var o=1;o<arguments.length;o++){var e=arguments[o]!=null?Object(arguments[o]):{},r=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),r.forEach(function(s){ue(d,s,e[s])})}return d}function ue(d,o,e){return o in d?Object.defineProperty(d,o,{value:e,enumerable:!0,configurable:!0,writable:!0}):d[o]=e,d}var M=function(o,e){var r=S({},o,e.attrs);return i(W,S({},r,{icon:_e}),null)};M.displayName="SettingOutlined";M.inheritAttrs=!1;const pe={class:"h-full pointer-events-none"},de=E({__name:"GridLines",setup(d){return(o,e)=>(c(),u("div",pe,[(c(!0),u($,null,w(l(F)(),r=>(c(),u("div",{style:T({left:`${r*l(x).size}px`}),class:"w-[1px] h-full bg-blue-200 absolute"},null,4))),256)),(c(!0),u($,null,w(l(N)(),r=>(c(),u("div",{style:T({top:`${r*l(x).size}px`}),class:"h-[1px] w-full bg-blue-200 absolute"},null,4))),256))]))}}),V=d=>{let o=Math.floor(d.offsetX/x.value.size),e=Math.floor(d.offsetY/x.value.size);return{x:o,y:e}},R=X("stage",{state:()=>({historyList:[]}),persist:!0}),me={class:"config"},fe=E({__name:"StageInit",setup(d,{expose:o}){const e=O(!0),r=O(),s=O({size:30,width:600,height:600,name:"",id:"",obstacles:[],hero:{left:0,top:0,figure:"left"}}),f=async()=>{var t,v;if(await((t=r.value)==null?void 0:t.validateFields())){n(),s.value.id=q();const _=R(),y=J(s.value).cloned.value;_.$state.historyList.push(y),x.value=y,(v=r.value)==null||v.resetFields()}},n=()=>{e.value=!e.value};return o({changeVisible:n}),(a,t)=>{const v=Q,_=Z,y=K,C=ee,j=te,B=se;return c(),u("div",me,[i(B,{open:l(e),"onUpdate:open":t[4]||(t[4]=h=>Y(e)?e.value=h:null),centered:"",title:"场景编辑",onOk:f,maskClosable:!1,keyboard:!1},{default:b(()=>[i(j,null,{default:b(()=>[i(C,{ref_key:"formRef",ref:r,model:l(s),onFinish:f},{default:b(()=>[i(_,{label:"地图名字",name:"name",required:""},{default:b(()=>[i(v,{"allow-clear":"",autofocus:"",value:l(s).name,"onUpdate:value":t[0]||(t[0]=h=>l(s).name=h)},null,8,["value"])]),_:1}),i(_,{label:"画布宽度",name:"width",required:""},{default:b(()=>[i(y,{max:1e3,value:l(s).width,"onUpdate:value":t[1]||(t[1]=h=>l(s).width=h),min:1},null,8,["value"])]),_:1}),i(_,{label:"画布高度",name:"height",required:""},{default:b(()=>[i(y,{max:900,value:l(s).height,"onUpdate:value":t[2]||(t[2]=h=>l(s).height=h),min:1},null,8,["value"])]),_:1}),i(_,{label:"网格大小",name:"size",required:"",help:"必须能被画布宽/高整除"},{default:b(()=>[i(y,{value:l(s).size,"onUpdate:value":t[3]||(t[3]=h=>l(s).size=h),min:1},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["open"])])}}}),z="/game/assets/wall_black-C7eTvGve.png",ve="/game/assets/wall_red-DDKfbgSg.png",m=O({image:z,obstacleType:"wall",pos:0}),ge=[{title:"黑白",value:z},{title:"红色",value:ve}],be=[{type:"wall",label:"绘制墙"},{type:"monster",label:"绘制怪物"}],ye={class:"editor-tabs"},he={class:"wall-list p-4"},xe={class:"flex gap-4"},$e=["onClick"],we=["src"],Ee={class:"text-gray-500"},Oe=E({__name:"WallConfig",setup(d){const o=e=>{m.value.image=e};return(e,r)=>(c(),u("div",ye,[p("div",he,[r[0]||(r[0]=p("div",{class:"font-bold text-[1.3rem] mb-4"},"墙体风格",-1)),p("ul",xe,[(c(!0),u($,null,w(l(ge),s=>(c(),u("li",{class:"text-center",key:s.value,onClick:f=>o(s.value)},[p("div",{class:D(["p-[1px]",{"active bg-blue-200":s.value===l(m).image}])},[p("img",{src:s.value,width:"32"},null,8,we)],2),p("div",Ee,I(s.title),1)],8,$e))),128))])])]))}}),Ce=k(Oe,[["__scopeId","data-v-30ff8e9b"]]),Le={class:"monster-list grid grid-cols-6 gap-2"},ke=["onClick"],Te=E({__name:"Monster",setup(d){const o=Object.assign({"/src/assets/monster/Monster01-01.png":()=>g(()=>import("./Monster01-01-Bz4ii5ef.js"),[]),"/src/assets/monster/Monster02-01.png":()=>g(()=>import("./Monster02-01-Pc9vyRJp.js"),[]),"/src/assets/monster/Monster03-01.png":()=>g(()=>import("./Monster03-01-D0-PQ3cQ.js"),[]),"/src/assets/monster/Monster04-01.png":()=>g(()=>import("./Monster04-01-BP4s9TQX.js"),[]),"/src/assets/monster/Monster06-01.png":()=>g(()=>import("./Monster06-01-XBD_fTJy.js"),[]),"/src/assets/monster/Monster07-01.png":()=>g(()=>import("./Monster07-01-C89zHzPq.js"),[]),"/src/assets/monster/Monster08-01.png":()=>g(()=>import("./Monster08-01-ASI0bJWT.js"),[]),"/src/assets/monster/Monster09-01.png":()=>g(()=>import("./Monster09-01-1QXvYVDa.js"),[]),"/src/assets/monster/Monster10-01.png":()=>g(()=>import("./Monster10-01-ChKnKcPJ.js"),[]),"/src/assets/monster/Monster11-01.png":()=>g(()=>import("./Monster11-01-CCVl6YGC.js"),[]),"/src/assets/monster/Monster13-01.png":()=>g(()=>import("./Monster13-01-BCiU7LVo.js"),[]),"/src/assets/monster/Monster14-01.png":()=>g(()=>import("./Monster14-01-nPJ38qm1.js"),[]),"/src/assets/monster/NPC01-01.png":()=>g(()=>import("./NPC01-01-B5GdBMKy.js"),[])});let e=O([]);function r(n){const a=/\/([^\/]+)\.png$/,t=n.match(a);return t&&t[1]?t[1]:null}Object.keys(o).forEach(n=>{r(n)&&e.value.push(n)});const s=(n,a)=>{m.value.image=n,m.value.pos=a},f=(n,a)=>({backgroundImage:`url(${n})`,backgroundPosition:`0px ${a*32}px`});return(n,a)=>(c(),u("div",null,[p("div",Le,[(c(!0),u($,null,w(l(e),(t,v)=>(c(),u($,null,[(c(),u($,null,w(4,_=>p("div",{onClick:y=>s(t,_),class:D([{active:t===l(m).image&&l(m).pos===_},"h-[32px] monster w-[32px] cursor-pointer"]),style:T(f(t,_))},null,14,ke)),64))],64))),256))])]))}}),De=k(Te,[["__scopeId","data-v-77258443"]]),Ie={class:""},Me={class:"flex flex-col gap-4"},Pe={class:"flex justify-between px-4 bg-slate-50 py-2"},Se={class:"flex gap-4"},Ve=E({__name:"EditorToolbar",emits:["displaysStageConfig"],setup(d,{emit:o}){const e=f=>{m.value.obstacleType=f},r=o,s=()=>{r("displaysStageConfig")};return(f,n)=>{const a=A,t=M,v=oe;return c(),u("div",Ie,[p("div",Me,[n[0]||(n[0]=p("div",{class:"font-bold text-[1.5rem] flex justify-between"},[p("div",null,"地图编辑")],-1)),p("div",Pe,[p("div",Se,[(c(!0),u($,null,w(l(be),_=>(c(),L(a,{type:_.type===l(m).obstacleType?"primary":"default",shape:"round",onClick:y=>e(_.type)},{default:b(()=>[le(I(_.label),1)]),_:2},1032,["type","onClick"]))),256))]),i(v,{title:"画布设置"},{default:b(()=>[i(a,{shape:"circle",type:"ghost",onClick:s},{icon:b(()=>[i(t)]),_:1})]),_:1})]),l(m).obstacleType==="wall"?(c(),L(Ce,{key:0})):l(m).obstacleType==="monster"?(c(),L(De,{key:1})):ne("",!0)])])}}}),Ae={class:"flex flex-col history-list w-[300px]"},Re={key:0,class:"max-h-[200px] overflow-auto mt-4 flex flex-col gap-4"},ze=["onClick"],je={class:"opacity-0 del"},Be=E({__name:"History",setup(d){const o=R(),e=f=>{o.$state.historyList=o.$state.historyList.filter(n=>n.id!==f)},r=f=>{x.value=f},s=ae(()=>o.$state.historyList);return(f,n)=>{const a=A,t=ie,v=ce;return c(),u("div",null,[p("div",Ae,[n[0]||(n[0]=p("div",{class:"font-bold text-[1.5rem]"},"历史记录",-1)),l(s).length>0?(c(),u("ul",Re,[(c(!0),u($,null,w(l(s),_=>(c(),u("li",{onClick:y=>r(_),class:D([{"active ":_.id===l(x).id},"px-4 flex justify-between items-center item hover:bg-gray-100 cursor-pointer"])},[p("div",null,I(_.name||"没有名称"),1),p("div",je,[i(t,{onConfirm:y=>e(_.id),title:"确定删除吗",placement:"bottomLeft"},{default:b(()=>[i(a,{shape:"circle",type:"ghost"},{default:b(()=>[i(l(re))]),_:1})]),_:2},1032,["onConfirm"])])],10,ze))),256))])):(c(),L(v,{key:1}))])])}}}),Fe=k(Be,[["__scopeId","data-v-b009f7b1"]]),Ne={class:"sidebar edit-toolbar bg-white absolute right-4 top-4 p-4"},qe={class:"absolute left-4 top-0 p-4"},Ue=E({__name:"index",setup(d){const o=O(null),e=()=>!!window.event.target.closest("#grid-container"),r=()=>{if(!e())return;const n=t=>{if(!e())return;const{x:v,y:_}=V(t);P({x:v,y:_,type:m.value.obstacleType,id:"",image:m.value.image,pos:m.value.pos})},a=()=>{window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",a)};window.addEventListener("mousemove",n),window.addEventListener("mouseup",a)},s=n=>{if(!e())return;const{x:a,y:t}=V(n);U({x:a,y:t})||P({x:a,y:t,type:m.value.obstacleType,id:"",image:m.value.image,pos:m.value.pos})},f=n=>{x.value.obstacles=x.value.obstacles.filter(a=>a.id!=n.id)};return(n,a)=>{const t=de,v=H,_=G;return c(),u("div",{class:"w-full h-full flex justify-center items-center bg-blue-950 relative",onClick:s,onMousedown:r},[i(_,null,{default:b(()=>[i(t),i(v,{onSelect:f}),i(fe,{ref_key:"stageRef",ref:o},null,512)]),_:1}),p("div",Ne,[i(Ve,{onDisplaysStageConfig:a[0]||(a[0]=y=>{var C;return(C=l(o))==null?void 0:C.changeVisible()})})]),p("div",qe,[i(Fe)])],32)}}}),We=k(Ue,[["__scopeId","data-v-82d45e5b"]]);export{We as default};
